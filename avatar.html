<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <style>
        body { margin: 0; background: #000; overflow: hidden; display: flex; justify-content: center; }
        video { width: 100vw; height: 100vh; object-fit: cover; filter: brightness(0.9); }
        #status { position: absolute; bottom: 20px; color: white; font-family: sans-serif; opacity: 0.3; }
    </style>
</head>
<body>
    <video id="avatarVideo" autoplay muted loop playsinline>
        <source src="https://assets.mixkit.co/videos/preview/mixkit-portrait-of-a-beautiful-woman-smiling-at-the-camera-40213-large.mp4" type="video/mp4">
    </video>
    <div id="status">متصل وجاهز للرد...</div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const video = document.getElementById('avatarVideo');

        socket.on('speak', (data) => {
            const speech = new SpeechSynthesisUtterance(data.text);
            speech.lang = 'ar-SA';
            speech.pitch = 1.1; // صوت أنثوي أكثر رقة
            speech.rate = 0.9;  // سرعة هادئة ووقورة

            speech.onstart = () => {
                video.style.filter = "brightness(1.1)"; // إضاءة خفيفة عند الكلام لتبدو متفاعلة
            };
            speech.onend = () => {
                video.style.filter = "brightness(0.9)";
            };

            window.speechSynthesis.speak(speech);
        });

        // تفعيل الصوت بلمسة واحدة
        document.body.onclick = () => {
            window.speechSynthesis.speak(new SpeechSynthesisUtterance(""));
            console.log("الصوت مفعل");
        };
    </script>
</body>
</html>
